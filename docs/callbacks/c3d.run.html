<!DOCTYPE html><html><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>c3d.run</title><meta property="og:title" content="c3d.run" /><meta property="og:type" content="website" /><meta name="description" content="The default main loop that the library uses for frame updates." /><meta property="og:description" content="The default main loop that the library uses for frame updates." /><meta property="og:image" content="https://c3d.madefor.cc/pack.png" /><meta property="og:site_name" content="C3D Docs" /><link rel="stylesheet" href="../main.css?v=07f8166c" type="text/css" /><meta name="theme-color" content="#c8d87c"></head><body><nav id="nav"><button id="nav-reveal" type="button">&#9776;</button><h1><a href=".././"><img src="../pack.png" alt="C3D Docs" /></a></h1><div class="nav-links"><h2 class="collapsed" tabindex="0">Modules</h2><ul><li><a href="../modules/c3d.camera.html" class="sidebar-link">c3d.camera</a></li><li><a href="../modules/c3d.event.html" class="sidebar-link">c3d.event</a></li><li><a href="../modules/c3d.geometry.html" class="sidebar-link">c3d.geometry</a></li><li><a href="../modules/c3d.graphics.html" class="sidebar-link">c3d.graphics</a></li><li><a href="../modules/c3d.interact.html" class="sidebar-link">c3d.interact</a></li><li><a href="../modules/c3d.keyboard.html" class="sidebar-link">c3d.keyboard</a></li><li><a href="../modules/c3d.mouse.html" class="sidebar-link">c3d.mouse</a></li><li><a href="../modules/c3d.perspective.html" class="sidebar-link">c3d.perspective</a></li><li><a href="../modules/c3d.pipe.html" class="sidebar-link">c3d.pipe</a></li><li><a href="../modules/c3d.scene.html" class="sidebar-link">c3d.scene</a></li><li><a href="../modules/c3d.shader.html" class="sidebar-link">c3d.shader</a></li><li><a href="../modules/c3d.sys.html" class="sidebar-link">c3d.sys</a></li><li><a href="../modules/c3d.thread.html" class="sidebar-link">c3d.thread</a></li><li><a href="../modules/c3d.timer.html" class="sidebar-link">c3d.timer</a></li><li><a href="../modules/c3d.vector.html" class="sidebar-link">c3d.vector</a></li></ul><h2 tabindex="0">Callbacks</h2><ul><li><a href="c3d.errorhandler.html" class="sidebar-link">c3d.errorhandler</a></li><li><a href="c3d.load.html" class="sidebar-link">c3d.load</a></li><li><a href="c3d.postrender.html" class="sidebar-link">c3d.postrender</a></li><li><a href="c3d.quit.html" class="sidebar-link">c3d.quit</a></li><li><a href="c3d.render.html" class="sidebar-link">c3d.render</a></li><li><strong class="sidebar-link selected">c3d.run</strong></li><li><a href="c3d.threaderror.html" class="sidebar-link">c3d.threaderror</a></li><li><a href="c3d.update.html" class="sidebar-link">c3d.update</a></li></ul><h2 class="collapsed" tabindex="0">Event-Callbacks</h2><ul><li><a href="../event-callbacks/c3d.keypressed.html" class="sidebar-link">c3d.keypressed</a></li><li><a href="../event-callbacks/c3d.keyreleased.html" class="sidebar-link">c3d.keyreleased</a></li><li><a href="../event-callbacks/c3d.mousemoved.html" class="sidebar-link">c3d.mousemoved</a></li><li><a href="../event-callbacks/c3d.mousepressed.html" class="sidebar-link">c3d.mousepressed</a></li><li><a href="../event-callbacks/c3d.mousereleased.html" class="sidebar-link">c3d.mousereleased</a></li><li><a href="../event-callbacks/c3d.textinput.html" class="sidebar-link">c3d.textinput</a></li><li><a href="../event-callbacks/c3d.wheelmoved.html" class="sidebar-link">c3d.wheelmoved</a></li></ul><h2 class="collapsed" tabindex="0">Object</h2><ul><li><a href="../objects/camera_object.html" class="sidebar-link">camera_object</a></li><li><a href="../objects/generic_shape.html" class="sidebar-link">generic_shape</a></li><li><a href="../objects/imported_model.html" class="sidebar-link">imported_model</a></li><li><a href="../objects/palette.html" class="sidebar-link">palette</a></li><li><a href="../objects/scene_object.html" class="sidebar-link">scene_object</a></li><li><a href="../objects/texture.html" class="sidebar-link">texture</a></li></ul><h2 class="collapsed" tabindex="0">Examples</h2><ul><li><a href="../examples/example.shader.html" class="sidebar-link">example.shader</a></li><li><a href="../examples/example.texturing.html" class="sidebar-link">example.texturing</a></li><li><a href="../examples/example.thread.html" class="sidebar-link">example.thread</a></li></ul><h2 class="collapsed" tabindex="0">Misc</h2><ul><li><a href="../misc/geometry_flags.html" class="sidebar-link">geometry_flags</a></li><li><a href="../misc/geometry_table_format.html" class="sidebar-link">geometry_table_format</a></li><li><a href="../misc/texture_load_settings.html" class="sidebar-link">texture_load_settings</a></li><li><a href="../misc/triangle_table.html" class="sidebar-link">triangle_table</a></li></ul></div></nav><div id="main"><div id="search-form" role="form"><input id="search-box" type="text" placeholder="Search..." autocomplete="off" tabindex="0"></input><div id="search-results"></div></div><section id="content"><h1>c3d.run</h1><p>The default main loop that the library uses for frame updates.
There is a default function set if you dont set one.
But you can modify it to your likings to perhaps inject code to the C3D code itself.
The default loop is saved at <code>C3D/core/uloop.lua</code></p>
<h2>returns</h2>
<ul>
<li><strong>function</strong>: the main update function to get loaded
</li>
</ul>
<p>showcase with the default function</p>
<pre class="highlight" data-lua-kind="stmt"><span class="keyword">function</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">run</span><span class="symbol">(</span><span class="symbol">)</span>
    <span class="keyword">if</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">load</span> <span class="keyword">then</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">load</span><span class="symbol">(</span><span class="ident">table</span><span class="symbol">.</span><span class="symbol">unpack</span><span class="symbol">(</span><span class="ident">args</span><span class="symbol">,</span><span class="number">1</span><span class="symbol">,</span><span class="ident">args</span><span class="symbol">.</span><span class="symbol">n</span><span class="symbol">)</span><span class="symbol">)</span> <span class="keyword">end</span>
    <span class="keyword">if</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">timer</span> <span class="keyword">then</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">timer</span><span class="symbol">.</span><span class="symbol">step</span><span class="symbol">(</span><span class="symbol">)</span> <span class="keyword">end</span>
    <span class="keyword">local</span> <span class="ident">dt</span> <span class="symbol">=</span> <span class="number">0</span>
    <span class="keyword">return</span> <span class="keyword">function</span><span class="symbol">(</span><span class="symbol">)</span>
        <span class="keyword">if</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">event</span> <span class="keyword">then</span>
            <span class="keyword">for</span> <span class="ident">name</span><span class="symbol">,</span> <span class="ident">a</span><span class="symbol">,</span><span class="ident">b</span><span class="symbol">,</span><span class="ident">c</span><span class="symbol">,</span><span class="ident">d</span><span class="symbol">,</span><span class="ident">e</span><span class="symbol">,</span><span class="ident">f</span> <span class="keyword">in</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">event</span><span class="symbol">.</span><span class="symbol">poll</span><span class="symbol">(</span><span class="symbol">)</span> <span class="keyword">do</span>
                <span class="keyword">if</span> <span class="ident">name</span> <span class="symbol">==</span> <span class="string">"quit"</span> <span class="keyword">then</span>
                    <span class="keyword">if</span> <span class="operator-kw">not</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">quit</span> <span class="operator-kw">or</span> <span class="operator-kw">not</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">quit</span><span class="symbol">(</span><span class="symbol">)</span> <span class="keyword">then</span>
                        <span class="keyword">return</span> <span class="ident">a</span> <span class="operator-kw">or</span> <span class="number">0</span>
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">handlers</span><span class="symbol">[</span><span class="ident">name</span><span class="symbol">]</span><span class="symbol">(</span><span class="ident">a</span><span class="symbol">,</span><span class="ident">b</span><span class="symbol">,</span><span class="ident">c</span><span class="symbol">,</span><span class="ident">d</span><span class="symbol">,</span><span class="ident">e</span><span class="symbol">,</span><span class="ident">f</span><span class="symbol">)</span>
            <span class="keyword">end</span>
        <span class="keyword">end</span>
        <span class="keyword">if</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">timer</span> <span class="keyword">then</span> <span class="ident">dt</span> <span class="symbol">=</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">timer</span><span class="symbol">.</span><span class="symbol">step</span><span class="symbol">(</span><span class="symbol">)</span> <span class="keyword">end</span>
        <span class="keyword">if</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">update</span> <span class="keyword">then</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">update</span><span class="symbol">(</span><span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">timer</span><span class="symbol">.</span><span class="symbol">get_average_delta</span><span class="symbol">(</span><span class="symbol">)</span><span class="symbol">)</span> <span class="keyword">end</span>
        <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">graphics</span><span class="symbol">.</span><span class="symbol">clear_buffer</span><span class="symbol">(</span><span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">graphics</span><span class="symbol">.</span><span class="symbol">get_bg</span><span class="symbol">(</span><span class="symbol">)</span><span class="symbol">)</span>
        <span class="keyword">if</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">render</span> <span class="keyword">then</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">render</span><span class="symbol">(</span><span class="symbol">)</span> <span class="keyword">end</span>
        <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">graphics</span><span class="symbol">.</span><span class="symbol">render_frame</span><span class="symbol">(</span><span class="symbol">)</span>
        <span class="keyword">if</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">timer</span> <span class="keyword">then</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">timer</span><span class="symbol">.</span><span class="symbol">sleep</span><span class="symbol">(</span><span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">sys</span><span class="symbol">.</span><span class="symbol">get_bus</span><span class="symbol">(</span><span class="symbol">)</span><span class="symbol">.</span><span class="symbol">sys</span><span class="symbol">.</span><span class="symbol">frame_time_min</span><span class="symbol">)</span> <span class="keyword">end</span>
        <span class="keyword">if</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">postrender</span> <span class="keyword">then</span> <span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">post_render</span><span class="symbol">(</span><span class="ident">c3d</span><span class="symbol">.</span><span class="symbol">sys</span><span class="symbol">.</span><span class="symbol">get_bus</span><span class="symbol">(</span><span class="symbol">)</span><span class="symbol">.</span><span class="symbol">graphics</span><span class="symbol">.</span><span class="symbol">display_source</span><span class="symbol">)</span> <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
<span class="symbol"></span></pre></section><footer>Last updated on 2022-10-24</footer></div><div id="search-overlay"></div><script src="../main.js?v=c0ed00b8" type="text/javascript" defer=""></script></body></html>